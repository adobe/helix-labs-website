/* esm.sh - diff@8.0.2 */
/* eslint-disable */
var C=class{diff(e,t,r={}){let i;typeof r=="function"?(i=r,r={}):"callback"in r&&(i=r.callback);let s=this.castInput(e,r),l=this.castInput(t,r),o=this.removeEmpty(this.tokenize(s,r)),f=this.removeEmpty(this.tokenize(l,r));return this.diffWithOptionsObj(o,f,r,i)}diffWithOptionsObj(e,t,r,i){var s;let l=a=>{if(a=this.postProcess(a,r),i){setTimeout(function(){i(a)},0);return}else return a},o=t.length,f=e.length,p=1,c=o+f;r.maxEditLength!=null&&(c=Math.min(c,r.maxEditLength));let m=(s=r.timeout)!==null&&s!==void 0?s:1/0,v=Date.now()+m,x=[{oldPos:-1,lastComponent:void 0}],d=this.extractCommon(x[0],t,e,0,r);if(x[0].oldPos+1>=f&&d+1>=o)return l(this.buildValues(x[0].lastComponent,t,e));let h=-1/0,w=1/0,W=()=>{for(let a=Math.max(h,-p);a<=Math.min(w,p);a+=2){let u,g=x[a-1],y=x[a+1];g&&(x[a-1]=void 0);let P=!1;if(y){let E=y.oldPos-a;P=y&&0<=E&&E<o}let O=g&&g.oldPos+1<f;if(!P&&!O){x[a]=void 0;continue}if(!O||P&&g.oldPos<y.oldPos?u=this.addToPath(y,!0,!1,0,r):u=this.addToPath(g,!1,!0,1,r),d=this.extractCommon(u,t,e,a,r),u.oldPos+1>=f&&d+1>=o)return l(this.buildValues(u.lastComponent,t,e))||!0;x[a]=u,u.oldPos+1>=f&&(w=Math.min(w,a-1)),d+1>=o&&(h=Math.max(h,a+1))}p++};if(i)(function a(){setTimeout(function(){if(p>c||Date.now()>v)return i(void 0);W()||a()},0)})();else for(;p<=c&&Date.now()<=v;){let a=W();if(a)return a}}addToPath(e,t,r,i,s){let l=e.lastComponent;return l&&!s.oneChangePerToken&&l.added===t&&l.removed===r?{oldPos:e.oldPos+i,lastComponent:{count:l.count+1,added:t,removed:r,previousComponent:l.previousComponent}}:{oldPos:e.oldPos+i,lastComponent:{count:1,added:t,removed:r,previousComponent:l}}}extractCommon(e,t,r,i,s){let l=t.length,o=r.length,f=e.oldPos,p=f-i,c=0;for(;p+1<l&&f+1<o&&this.equals(r[f+1],t[p+1],s);)p++,f++,c++,s.oneChangePerToken&&(e.lastComponent={count:1,previousComponent:e.lastComponent,added:!1,removed:!1});return c&&!s.oneChangePerToken&&(e.lastComponent={count:c,previousComponent:e.lastComponent,added:!1,removed:!1}),e.oldPos=f,p}equals(e,t,r){return r.comparator?r.comparator(e,t):e===t||!!r.ignoreCase&&e.toLowerCase()===t.toLowerCase()}removeEmpty(e){let t=[];for(let r=0;r<e.length;r++)e[r]&&t.push(e[r]);return t}castInput(e,t){return e}tokenize(e,t){return Array.from(e)}join(e){return e.join("")}postProcess(e,t){return e}get useLongestToken(){return!1}buildValues(e,t,r){let i=[],s;for(;e;)i.push(e),s=e.previousComponent,delete e.previousComponent,e=s;i.reverse();let l=i.length,o=0,f=0,p=0;for(;o<l;o++){let c=i[o];if(c.removed)c.value=this.join(r.slice(p,p+c.count)),p+=c.count;else{if(!c.added&&this.useLongestToken){let m=t.slice(f,f+c.count);m=m.map(function(v,x){let d=r[p+x];return d.length>v.length?d:v}),c.value=this.join(m)}else c.value=this.join(t.slice(f,f+c.count));f+=c.count,c.added||(p+=c.count)}}return i}};var I=class extends C{},ee=new I;function we(n,e,t){return ee.diff(n,e,t)}function $(n,e){let t;for(t=0;t<n.length&&t<e.length;t++)if(n[t]!=e[t])return n.slice(0,t);return n.slice(0,t)}function M(n,e){let t;if(!n||!e||n[n.length-1]!=e[e.length-1])return"";for(t=0;t<n.length&&t<e.length;t++)if(n[n.length-(t+1)]!=e[e.length-(t+1)])return n.slice(-t);return n.slice(-t)}function T(n,e,t){if(n.slice(0,e.length)!=e)throw Error(`string ${JSON.stringify(n)} doesn't start with prefix ${JSON.stringify(e)}; this is a bug`);return t+n.slice(e.length)}function N(n,e,t){if(!e)return n+t;if(n.slice(-e.length)!=e)throw Error(`string ${JSON.stringify(n)} doesn't end with suffix ${JSON.stringify(e)}; this is a bug`);return n.slice(0,-e.length)+t}function S(n,e){return T(n,e,"")}function F(n,e){return N(n,e,"")}function R(n,e){return e.slice(0,ve(n,e))}function ve(n,e){let t=0;n.length>e.length&&(t=n.length-e.length);let r=e.length;n.length<e.length&&(r=n.length);let i=Array(r),s=0;i[0]=0;for(let l=1;l<r;l++){for(e[l]==e[s]?i[l]=i[s]:i[l]=s;s>0&&e[l]!=e[s];)s=i[s];e[l]==e[s]&&s++}s=0;for(let l=t;l<n.length;l++){for(;s>0&&n[l]!=e[s];)s=i[s];n[l]==e[s]&&s++}return s}function ne(n){return n.includes(`\r
`)&&!n.startsWith(`
`)&&!n.match(/[^\r]\n/)}function te(n){return!n.includes(`\r
`)&&n.includes(`
`)}function k(n){let e;for(e=n.length-1;e>=0&&n[e].match(/\s/);e--);return n.substring(e+1)}function L(n){let e=n.match(/^\s*/);return e?e[0]:""}var A="a-zA-Z0-9_\\u{C0}-\\u{FF}\\u{D8}-\\u{F6}\\u{F8}-\\u{2C6}\\u{2C8}-\\u{2D7}\\u{2DE}-\\u{2FF}\\u{1E00}-\\u{1EFF}",ye=new RegExp(`[${A}]+|\\s+|[^${A}]`,"ug"),J=class extends C{equals(e,t,r){return r.ignoreCase&&(e=e.toLowerCase(),t=t.toLowerCase()),e.trim()===t.trim()}tokenize(e,t={}){let r;if(t.intlSegmenter){let l=t.intlSegmenter;if(l.resolvedOptions().granularity!="word")throw new Error('The segmenter passed must have a granularity of "word"');r=Array.from(l.segment(e),o=>o.segment)}else r=e.match(ye)||[];let i=[],s=null;return r.forEach(l=>{/\s/.test(l)?s==null?i.push(l):i.push(i.pop()+l):s!=null&&/\s/.test(s)?i[i.length-1]==s?i.push(i.pop()+l):i.push(s+l):i.push(l),s=l}),i}join(e){return e.map((t,r)=>r==0?t:t.replace(/^\s+/,"")).join("")}postProcess(e,t){if(!e||t.oneChangePerToken)return e;let r=null,i=null,s=null;return e.forEach(l=>{l.added?i=l:l.removed?s=l:((i||s)&&re(r,s,i,l),r=l,i=null,s=null)}),(i||s)&&re(r,s,i,null),e}},ie=new J;function We(n,e,t){return t?.ignoreWhitespace!=null&&!t.ignoreWhitespace?le(n,e,t):ie.diff(n,e,t)}function re(n,e,t,r){if(e&&t){let i=L(e.value),s=k(e.value),l=L(t.value),o=k(t.value);if(n){let f=$(i,l);n.value=N(n.value,l,f),e.value=S(e.value,f),t.value=S(t.value,f)}if(r){let f=M(s,o);r.value=T(r.value,o,f),e.value=F(e.value,f),t.value=F(t.value,f)}}else if(t){if(n){let i=L(t.value);t.value=t.value.substring(i.length)}if(r){let i=L(r.value);r.value=r.value.substring(i.length)}}else if(n&&r){let i=L(r.value),s=L(e.value),l=k(e.value),o=$(i,s);e.value=S(e.value,o);let f=M(S(i,o),l);e.value=F(e.value,f),r.value=T(r.value,i,f),n.value=N(n.value,i,i.slice(0,i.length-f.length))}else if(r){let i=L(r.value),s=k(e.value),l=R(s,i);e.value=F(e.value,l)}else if(n){let i=k(n.value),s=L(e.value),l=R(i,s);e.value=S(e.value,l)}}var q=class extends C{tokenize(e){let t=new RegExp(`(\\r?\\n)|[${A}]+|[^\\S\\n\\r]+|[^${A}]`,"ug");return e.match(t)||[]}},se=new q;function le(n,e,t){return se.diff(n,e,t)}function oe(n,e){if(typeof n=="function")e.callback=n;else if(n)for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e}var U=class extends C{constructor(){super(...arguments),this.tokenize=V}equals(e,t,r){return r.ignoreWhitespace?((!r.newlineIsToken||!e.includes(`
`))&&(e=e.trim()),(!r.newlineIsToken||!t.includes(`
`))&&(t=t.trim())):r.ignoreNewlineAtEof&&!r.newlineIsToken&&(e.endsWith(`
`)&&(e=e.slice(0,-1)),t.endsWith(`
`)&&(t=t.slice(0,-1))),super.equals(e,t,r)}},_=new U;function b(n,e,t){return _.diff(n,e,t)}function Ce(n,e,t){return t=oe(t,{ignoreWhitespace:!0}),_.diff(n,e,t)}function V(n,e){e.stripTrailingCr&&(n=n.replace(/\r\n/g,`
`));let t=[],r=n.split(/(\n|\r\n)/);r[r.length-1]||r.pop();for(let i=0;i<r.length;i++){let s=r[i];i%2&&!e.newlineIsToken?t[t.length-1]+=s:t.push(s)}return t}function Oe(n){return n=="."||n=="!"||n=="?"}var X=class extends C{tokenize(e){var t;let r=[],i=0;for(let s=0;s<e.length;s++){if(s==e.length-1){r.push(e.slice(i));break}if(Oe(e[s])&&e[s+1].match(/\s/)){for(r.push(e.slice(i,s+1)),s=i=s+1;!((t=e[s+1])===null||t===void 0)&&t.match(/\s/);)s++;r.push(e.slice(i,s+1)),i=s+1}}return r}},fe=new X;function Pe(n,e,t){return fe.diff(n,e,t)}var B=class extends C{tokenize(e){return e.split(/([{}:;,]|\s+)/)}},ue=new B;function Le(n,e,t){return ue.diff(n,e,t)}var Z=class extends C{constructor(){super(...arguments),this.tokenize=V}get useLongestToken(){return!0}castInput(e,t){let{undefinedReplacement:r,stringifyReplacer:i=(s,l)=>typeof l>"u"?r:l}=t;return typeof e=="string"?e:JSON.stringify(z(e,null,null,i),null,"  ")}equals(e,t,r){return super.equals(e.replace(/,([\r\n])/g,"$1"),t.replace(/,([\r\n])/g,"$1"),r)}},ae=new Z;function Ee(n,e,t){return ae.diff(n,e,t)}function z(n,e,t,r,i){e=e||[],t=t||[],r&&(n=r(i===void 0?"":i,n));let s;for(s=0;s<e.length;s+=1)if(e[s]===n)return t[s];let l;if(Object.prototype.toString.call(n)==="[object Array]"){for(e.push(n),l=new Array(n.length),t.push(l),s=0;s<n.length;s+=1)l[s]=z(n[s],e,t,r,String(s));return e.pop(),t.pop(),l}if(n&&n.toJSON&&(n=n.toJSON()),typeof n=="object"&&n!==null){e.push(n),l={},t.push(l);let o=[],f;for(f in n)Object.prototype.hasOwnProperty.call(n,f)&&o.push(f);for(o.sort(),s=0;s<o.length;s+=1)f=o[s],l[f]=z(n[f],e,t,r,f);e.pop(),t.pop()}else l=n;return l}var G=class extends C{tokenize(e){return e.slice()}join(e){return e}removeEmpty(e){return e}},ce=new G;function Se(n,e,t){return ce.diff(n,e,t)}function Q(n){return Array.isArray(n)?n.map(e=>Q(e)):Object.assign(Object.assign({},n),{hunks:n.hunks.map(e=>Object.assign(Object.assign({},e),{lines:e.lines.map((t,r)=>{var i;return t.startsWith("\\")||t.endsWith("\r")||!((i=e.lines[r+1])===null||i===void 0)&&i.startsWith("\\")?t:t+"\r"})}))})}function Y(n){return Array.isArray(n)?n.map(e=>Y(e)):Object.assign(Object.assign({},n),{hunks:n.hunks.map(e=>Object.assign(Object.assign({},e),{lines:e.lines.map(t=>t.endsWith("\r")?t.substring(0,t.length-1):t)}))})}function de(n){return Array.isArray(n)||(n=[n]),!n.some(e=>e.hunks.some(t=>t.lines.some(r=>!r.startsWith("\\")&&r.endsWith("\r"))))}function me(n){return Array.isArray(n)||(n=[n]),n.some(e=>e.hunks.some(t=>t.lines.some(r=>r.endsWith("\r"))))&&n.every(e=>e.hunks.every(t=>t.lines.every((r,i)=>{var s;return r.startsWith("\\")||r.endsWith("\r")||((s=t.lines[i+1])===null||s===void 0?void 0:s.startsWith("\\"))})))}function D(n){let e=n.split(/\n/),t=[],r=0;function i(){let o={};for(t.push(o);r<e.length;){let f=e[r];if(/^(---|\+\+\+|@@)\s/.test(f))break;let p=/^(?:Index:|diff(?: -r \w+)+)\s+(.+?)\s*$/.exec(f);p&&(o.index=p[1]),r++}for(s(o),s(o),o.hunks=[];r<e.length;){let f=e[r];if(/^(Index:\s|diff\s|---\s|\+\+\+\s|===================================================================)/.test(f))break;if(/^@@/.test(f))o.hunks.push(l());else{if(f)throw new Error("Unknown line "+(r+1)+" "+JSON.stringify(f));r++}}}function s(o){let f=/^(---|\+\+\+)\s+(.*)\r?$/.exec(e[r]);if(f){let p=f[2].split("	",2),c=(p[1]||"").trim(),m=p[0].replace(/\\\\/g,"\\");/^".*"$/.test(m)&&(m=m.substr(1,m.length-2)),f[1]==="---"?(o.oldFileName=m,o.oldHeader=c):(o.newFileName=m,o.newHeader=c),r++}}function l(){var o;let f=r,p=e[r++],c=p.split(/@@ -(\d+)(?:,(\d+))? \+(\d+)(?:,(\d+))? @@/),m={oldStart:+c[1],oldLines:typeof c[2]>"u"?1:+c[2],newStart:+c[3],newLines:typeof c[4]>"u"?1:+c[4],lines:[]};m.oldLines===0&&(m.oldStart+=1),m.newLines===0&&(m.newStart+=1);let v=0,x=0;for(;r<e.length&&(x<m.oldLines||v<m.newLines||!((o=e[r])===null||o===void 0)&&o.startsWith("\\"));r++){let d=e[r].length==0&&r!=e.length-1?" ":e[r][0];if(d==="+"||d==="-"||d===" "||d==="\\")m.lines.push(e[r]),d==="+"?v++:d==="-"?x++:d===" "&&(v++,x++);else throw new Error(`Hunk at line ${f+1} contained invalid line ${e[r]}`)}if(!v&&m.newLines===1&&(m.newLines=0),!x&&m.oldLines===1&&(m.oldLines=0),v!==m.newLines)throw new Error("Added line count did not match for hunk at line "+(f+1));if(x!==m.oldLines)throw new Error("Removed line count did not match for hunk at line "+(f+1));return m}for(;r<e.length;)i();return t}function he(n,e,t){let r=!0,i=!1,s=!1,l=1;return function o(){if(r&&!s){if(i?l++:r=!1,n+l<=t)return n+l;s=!0}if(!i)return s||(r=!0),e<=n-l?n-l++:(i=!0,o())}}function pe(n,e,t={}){let r;if(typeof e=="string"?r=D(e):Array.isArray(e)?r=e:r=[e],r.length>1)throw new Error("applyPatch only works with a single input.");return ke(n,r[0],t)}function ke(n,e,t={}){(t.autoConvertLineEndings||t.autoConvertLineEndings==null)&&(ne(n)&&de(e)?e=Q(e):te(n)&&me(e)&&(e=Y(e)));let r=n.split(`
`),i=e.hunks,s=t.compareLine||((d,h,w,W)=>h===W),l=t.fuzzFactor||0,o=0;if(l<0||!Number.isInteger(l))throw new Error("fuzzFactor must be a non-negative integer");if(!i.length)return n;let f="",p=!1,c=!1;for(let d=0;d<i[i.length-1].lines.length;d++){let h=i[i.length-1].lines[d];h[0]=="\\"&&(f[0]=="+"?p=!0:f[0]=="-"&&(c=!0)),f=h}if(p){if(c){if(!l&&r[r.length-1]=="")return!1}else if(r[r.length-1]=="")r.pop();else if(!l)return!1}else if(c){if(r[r.length-1]!="")r.push("");else if(!l)return!1}function m(d,h,w,W=0,a=!0,u=[],g=0){let y=0,P=!1;for(;W<d.length;W++){let O=d[W],E=O.length>0?O[0]:" ",H=O.length>0?O.substr(1):O;if(E==="-")if(s(h+1,r[h],E,H))h++,y=0;else return!w||r[h]==null?null:(u[g]=r[h],m(d,h+1,w-1,W,!1,u,g+1));if(E==="+"){if(!a)return null;u[g]=H,g++,y=0,P=!0}if(E===" ")if(y++,u[g]=r[h],s(h+1,r[h],E,H))g++,a=!0,P=!1,h++;else return P||!w?null:r[h]&&(m(d,h+1,w-1,W+1,!1,u,g+1)||m(d,h+1,w-1,W,!1,u,g+1))||m(d,h,w-1,W+1,!1,u,g)}return g-=y,h-=y,u.length=g,{patchedLines:u,oldLineLastI:h-1}}let v=[],x=0;for(let d=0;d<i.length;d++){let h=i[d],w,W=r.length-h.oldLines+l,a;for(let u=0;u<=l;u++){a=h.oldStart+x-1;let g=he(a,o,W);for(;a!==void 0&&(w=m(h.lines,a,u),!w);a=g());if(w)break}if(!w)return!1;for(let u=o;u<a;u++)v.push(r[u]);for(let u=0;u<w.patchedLines.length;u++){let g=w.patchedLines[u];v.push(g)}o=w.oldLineLastI+1,x=a+1-h.oldStart}for(let d=o;d<r.length;d++)v.push(r[d]);return v.join(`
`)}function Fe(n,e){let t=typeof n=="string"?D(n):n,r=0;function i(){let s=t[r++];if(!s)return e.complete();e.loadFile(s,function(l,o){if(l)return e.complete(l);let f=pe(o,s,e);e.patched(s,f,function(p){if(p)return e.complete(p);i()})})}i()}function ge(n){return Array.isArray(n)?n.map(e=>ge(e)).reverse():Object.assign(Object.assign({},n),{oldFileName:n.newFileName,oldHeader:n.newHeader,newFileName:n.oldFileName,newHeader:n.oldHeader,hunks:n.hunks.map(e=>({oldLines:e.newLines,oldStart:e.newStart,newLines:e.oldLines,newStart:e.oldStart,lines:e.lines.map(t=>t.startsWith("-")?`+${t.slice(1)}`:t.startsWith("+")?`-${t.slice(1)}`:t)}))})}function K(n,e,t,r,i,s,l){let o;l?typeof l=="function"?o={callback:l}:o=l:o={},typeof o.context>"u"&&(o.context=4);let f=o.context;if(o.newlineIsToken)throw new Error("newlineIsToken may not be used with patch-generation functions, only with diffing functions");if(o.callback){let{callback:c}=o;b(t,r,Object.assign(Object.assign({},o),{callback:m=>{let v=p(m);c(v)}}))}else return p(b(t,r,o));function p(c){if(!c)return;c.push({value:"",lines:[]});function m(a){return a.map(function(u){return" "+u})}let v=[],x=0,d=0,h=[],w=1,W=1;for(let a=0;a<c.length;a++){let u=c[a],g=u.lines||Ne(u.value);if(u.lines=g,u.added||u.removed){if(!x){let y=c[a-1];x=w,d=W,y&&(h=f>0?m(y.lines.slice(-f)):[],x-=h.length,d-=h.length)}for(let y of g)h.push((u.added?"+":"-")+y);u.added?W+=g.length:w+=g.length}else{if(x)if(g.length<=f*2&&a<c.length-2)for(let y of m(g))h.push(y);else{let y=Math.min(g.length,f);for(let O of m(g.slice(0,y)))h.push(O);let P={oldStart:x,oldLines:w-x+y,newStart:d,newLines:W-d+y,lines:h};v.push(P),x=0,d=0,h=[]}w+=g.length,W+=g.length}}for(let a of v)for(let u=0;u<a.lines.length;u++)a.lines[u].endsWith(`
`)?a.lines[u]=a.lines[u].slice(0,-1):(a.lines.splice(u+1,0,"\\ No newline at end of file"),u++);return{oldFileName:n,newFileName:e,oldHeader:i,newHeader:s,hunks:v}}}function j(n){if(Array.isArray(n))return n.map(j).join(`
`);let e=[];n.oldFileName==n.newFileName&&e.push("Index: "+n.oldFileName),e.push("==================================================================="),e.push("--- "+n.oldFileName+(typeof n.oldHeader>"u"?"":"	"+n.oldHeader)),e.push("+++ "+n.newFileName+(typeof n.newHeader>"u"?"":"	"+n.newHeader));for(let t=0;t<n.hunks.length;t++){let r=n.hunks[t];r.oldLines===0&&(r.oldStart-=1),r.newLines===0&&(r.newStart-=1),e.push("@@ -"+r.oldStart+","+r.oldLines+" +"+r.newStart+","+r.newLines+" @@");for(let i of r.lines)e.push(i)}return e.join(`
`)+`
`}function xe(n,e,t,r,i,s,l){if(typeof l=="function"&&(l={callback:l}),l?.callback){let{callback:o}=l;K(n,e,t,r,i,s,Object.assign(Object.assign({},l),{callback:f=>{o(f?j(f):void 0)}}))}else{let o=K(n,e,t,r,i,s,l);return o?j(o):void 0}}function Te(n,e,t,r,i,s){return xe(n,n,e,t,r,i,s)}function Ne(n){let e=n.endsWith(`
`),t=n.split(`
`).map(r=>r+`
`);return e?t.pop():t.push(t.pop().slice(0,-1)),t}function Ae(n){let e=[],t,r;for(let i=0;i<n.length;i++)t=n[i],t.added?r=1:t.removed?r=-1:r=0,e.push([r,t.value]);return e}function be(n){let e=[];for(let t=0;t<n.length;t++){let r=n[t];r.added?e.push("<ins>"):r.removed&&e.push("<del>"),e.push(ze(r.value)),r.added?e.push("</ins>"):r.removed&&e.push("</del>")}return e.join("")}function ze(n){let e=n;return e=e.replace(/&/g,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=e.replace(/"/g,"&quot;"),e}export{C as Diff,pe as applyPatch,Fe as applyPatches,ce as arrayDiff,z as canonicalize,ee as characterDiff,Ae as convertChangesToDMP,be as convertChangesToXML,Te as createPatch,xe as createTwoFilesPatch,ue as cssDiff,Se as diffArrays,we as diffChars,Le as diffCss,Ee as diffJson,b as diffLines,Pe as diffSentences,Ce as diffTrimmedLines,We as diffWords,le as diffWordsWithSpace,j as formatPatch,ae as jsonDiff,_ as lineDiff,D as parsePatch,ge as reversePatch,fe as sentenceDiff,K as structuredPatch,ie as wordDiff,se as wordsWithSpaceDiff};
//# sourceMappingURL=diff.mjs.map